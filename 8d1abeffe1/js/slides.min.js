!function(){function t(t,e,s){var i=document.createElement("figure");s.split(" ").forEach(function(t){i.classList.add(t)});var o=document.createElement("img"),n=document.createElement("figcaption");return o.src=t,o.alt=e,n.textContent=e,i.appendChild(o),i.appendChild(n),i}function e(){c.textContent=g+1+n+p.length}function s(t){a=t.autoplayTime||3e3,n=t.counterSeparator||" / ",m=document.querySelector(t.id),l=m.querySelector(".slides"),d=m.querySelector(".status"),r=m.querySelector(".prev"),h=m.querySelector(".next"),c=m.querySelector(".counter"),u=m.querySelector("nav"),p=l.children,g=0,t.slides?(o=t.slides,this.init(),this.play()):t.json&&(request=new XMLHttpRequest,request.onreadystatechange=function(){4===request.readyState&&(200===request.status?(o=JSON.parse(request.responseText).imgs,this.init(),this.play()):console.error("There was a problem with the request."))}.bind(this),request.open("GET",t.json),request.send())}function i(t){this.threshold=100,this.allowedTime=250,this.slideshow=t,this.startX=0,this.startY=0,this.dist=0,this.elapsedTime=null,this.startTime=null}var o,n,a,l,d,r,h,c,u,p,g,m;s.prototype.slideTo=function(t){p.item(g).classList.toggle("show"),p.item(t).classList.toggle("show"),u.children.item(g).classList.toggle("active"),u.children.item(t).classList.toggle("active"),g=t,e()},s.prototype.nextSlide=function(){this.slideTo((g+1)%p.length)},s.prototype.prevSlide=function(){var t=p.length;this.slideTo(((g-1)%t+t)%t)},s.prototype.init=function(){for(var s=screen.width<=768?"small":"large",n=0;n<o.length;n++)l.appendChild(t("../backofficeimages/"+s+"/"+o[n].name,o[n].desc,o[n].transition));for(var c=p.length,n=0;c>n;n++){var y=document.createElement("a");y.href="#",y.title="Go to nÂ°"+(n+1),y.classList.add("bullet"),y.addEventListener("click",function(){this.slideshow.slideTo(this.to)}.bind({slideshow:this,to:n})),u.appendChild(y)}e(),p.item(g).classList.add("show"),u.children.item(g).classList.add("active"),h.addEventListener("click",this.nextSlide.bind(this)),r.addEventListener("click",this.prevSlide.bind(this)),d.addEventListener("click",this.toggleAutoplay.bind(this));var v=new i(this);m.addEventListener("touchstart",v.start.bind(v)),m.addEventListener("touchmove",v.move.bind(v)),m.addEventListener("touchend",v.end.bind(v)),m.addEventListener("mouseover",this.toggleAutoplay.bind(this)),m.addEventListener("mouseout",this.toggleAutoplay.bind(this)),m.addEventListener("focus",this.toggleAutoplay.bind(this)),m.addEventListener("blur",this.toggleAutoplay.bind(this));var f=function(){this.autoplay&&this.nextSlide(),setTimeout(f.bind(this),a)};setTimeout(f.bind(this),a)},s.prototype.play=function(){this.autoplay=!0,d.classList.add("playing"),d.classList.remove("stopped")},s.prototype.pause=function(){this.autoplay=!1,d.classList.remove("playing"),d.classList.add("stopped")},s.prototype.toggleAutoplay=function(){this.autoplay=this.autoplay?!1:!0,d.classList.toggle("playing"),d.classList.toggle("stopped")},i.prototype.start=function(t){console.log("touchstart"),this.slideshow.pause();var e=t.changedTouches[0];this.dist=0,this.startX=e.pageX,this.startY=e.pageY,this.startTime=(new Date).getTime()},i.prototype.move=function(t){t.preventDefault()},i.prototype.end=function(t){console.log("touchend");var e=t.changedTouches[0];this.dist=e.pageX-this.startX,this.elapsedTime=(new Date).getTime()-this.startTime,this.elapsedTime<=this.allowedTime&&Math.abs(this.dist)>=this.threshold&&Math.abs(e.pageY-this.startY)<=100&&(e.pageX-this.startX<0?this.slideshow.nextSlide():this.slideshow.prevSlide()),this.slideshow.play()},window.Slideshow=s,_slides&&new s(_slides)}();
